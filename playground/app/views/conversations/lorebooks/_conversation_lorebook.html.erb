<%# Conversation Lorebook Row %>
<%# locals: (conversation_lorebook:, conversation:) %>
<%= tag.div id: dom_id(conversation_lorebook), class: "flex items-center gap-2 p-2 bg-base-200 rounded-box", data: { sortable_item: "", entry_id: conversation_lorebook.id } do %>
  <%# Drag Handle %>
  <div class="cursor-grab text-base-content/30 hover:text-base-content/50" data-sortable-handle="">
    <span class="icon-[lucide--grip-vertical] size-3"></span>
  </div>

  <%# Toggle %>
  <%= button_to toggle_conversation_lorebook_path(conversation, conversation_lorebook),
      method: :patch,
      class: "btn btn-ghost btn-xs btn-circle",
      data: { turbo_frame: dom_id(conversation_lorebook) } do %>
    <% if conversation_lorebook.enabled %>
      <span class="icon-[lucide--eye] size-3 text-success"></span>
    <% else %>
      <span class="icon-[lucide--eye-off] size-3 text-base-content/30"></span>
    <% end %>
  <% end %>

  <%# Info %>
  <div class="flex-1 min-w-0">
    <div class="flex items-center gap-1">
      <%= link_to conversation_lorebook.lorebook.name,
          lorebook_path(conversation_lorebook.lorebook),
          class: "text-xs font-medium hover:text-primary truncate",
          target: "_blank" %>
    </div>
    <p class="text-[10px] text-base-content/50">
      <%= t("conversation_lorebooks.entries_count", count: conversation_lorebook.lorebook.entries.count, default: "%{count} entries") %>
    </p>
  </div>

  <%# Remove %>
  <%= button_to conversation_lorebook_path(conversation, conversation_lorebook),
      method: :delete,
      class: "btn btn-ghost btn-xs btn-circle text-error",
      data: { turbo_confirm: t("conversation_lorebooks.detach_confirm", default: "Detach this lorebook from chat?") } do %>
    <span class="icon-[lucide--x] size-3"></span>
  <% end %>
<% end %>
