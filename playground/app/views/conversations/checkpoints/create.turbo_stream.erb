<%# Turbo Stream response for checkpoint creation %>
<%# Shows a toast notification with (optional) link to the checkpoint %>

<% if @async %>
  <%= turbo_stream.action :show_toast, nil,
                          partial: "shared/toast",
                          locals: {
                            message: t("checkpoints.creating", default: "Creating checkpoint..."),
                            type: :info,
                            duration: 3000,
                          } %>
<% else %>
  <%
    checkpoint_link = link_to(
      @checkpoint.title,
      conversation_url(@checkpoint),
      class: "link link-hover underline"
    )

    message = safe_join([
      t("checkpoints.created", default: "Checkpoint saved"),
      ": ",
      checkpoint_link,
    ])
  %>

  <%= turbo_stream.action :show_toast, nil,
                          partial: "shared/toast",
                          locals: {
                            message: message,
                            type: :success,
                            duration: 5000,
                          } %>
<% end %>
