<% content_for :title, t("playgrounds.edit.title", default: "Edit Playground") %>
<% content_for :main_class, "flex-1 p-4 md:p-6 lg:p-8" %>

<% conversation = @playground.conversations.root.first %>
<% back_path = conversation ? conversation_path(conversation) : playground_path(@playground) %>

<div class="max-w-4xl mx-auto space-y-6">
  <%# Breadcrumbs %>
  <div class="breadcrumbs text-sm">
    <ul>
      <li>
        <%= link_to conversations_path do %>
          <span class="icon-[lucide--messages-square] size-4 mr-1"></span>
          <%= t("conversations.index.title", default: "Conversations") %>
        <% end %>
      </li>
      <li>
        <%= link_to back_path do %>
          <span class="icon-[lucide--layout-template] size-4 mr-1"></span>
          <%= @playground.name.truncate(30) %>
        <% end %>
      </li>
      <li><%= t("playgrounds.edit.title", default: "Edit Playground") %></li>
    </ul>
  </div>

  <%# Back button %>
  <%= link_to back_path, class: "btn btn-ghost btn-sm gap-2 -mt-4 mb-2" do %>
    <span class="icon-[lucide--arrow-left] size-4"></span>
    <%= t("common.back", default: "Back") %>
  <% end %>

  <%# Header %>
  <div>
    <h1 class="text-2xl font-bold flex items-center gap-3">
      <span class="icon-[lucide--settings] size-7 text-primary"></span>
      <%= t("playgrounds.edit.title", default: "Edit Playground") %>
    </h1>
    <p class="text-base-content/60 mt-1">
      <%= t("playgrounds.edit.description", default: "Update space settings and prompt behavior.") %>
    </p>
  </div>

  <%= render "form", playground: @playground, characters: @characters %>

  <%# Danger zone %>
  <div class="card bg-base-100 shadow-sm border border-error/30">
    <div class="card-body">
      <h2 class="card-title text-lg text-error gap-2">
        <span class="icon-[lucide--alert-triangle] size-5"></span>
        <%= t("playgrounds.edit.danger_zone", default: "Danger Zone") %>
      </h2>

      <p class="text-sm text-base-content/60 mb-4">
        <%= t("playgrounds.edit.delete_warning", default: "Deleting this playground will permanently remove all conversations and messages and cannot be undone.") %>
      </p>

      <%= button_to playground_path(@playground),
                    method: :delete,
                    class: "btn btn-error btn-sm gap-2",
                    data: { turbo_confirm: t("playgrounds.edit.delete_confirm", default: "Are you sure you want to delete this playground?") } do %>
        <span class="icon-[lucide--trash-2] size-4"></span>
        <%= t("playgrounds.edit.delete", default: "Delete Playground") %>
      <% end %>
    </div>
  </div>
</div>
