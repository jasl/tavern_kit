<% content_for(:body_class, "min-h-dvh bg-base-100") %>
<% content_for :content do %>
  <%= render "shared/flash" %>
  <%= render "layouts/navbar" %>

  <main class="w-full max-w-7xl mx-auto px-4 md:px-6 lg:px-8 py-6 md:py-8">
    <div class="flex flex-col lg:flex-row gap-6">
      <%# Sidebar navigation %>
      <aside class="lg:w-64 shrink-0">
        <%# Mobile tabs %>
        <div class="lg:hidden mb-4">
          <div class="tabs tabs-box">
            <%= link_to settings_llm_providers_path,
                        class: "tab flex-1 gap-2 #{settings_section_active?(:llm_providers) ? "tab-active" : ""}" do %>
              <span class="icon-[lucide--bot] size-4"></span>
              <%= t("settings.llm_providers.title", default: "LLM Providers") %>
            <% end %>
            <%= link_to settings_characters_path,
                        class: "tab flex-1 gap-2 #{settings_section_active?(:characters) ? "tab-active" : ""}" do %>
              <span class="icon-[lucide--users] size-4"></span>
              <%= t("settings.characters.title", default: "Characters") %>
            <% end %>
            <%= link_to settings_presets_path,
                        class: "tab flex-1 gap-2 #{settings_section_active?(:presets) ? "tab-active" : ""}" do %>
              <span class="icon-[lucide--sliders-horizontal] size-4"></span>
              <%= t("settings.presets.title", default: "Presets") %>
            <% end %>
            <%= link_to settings_lorebooks_path,
                        class: "tab flex-1 gap-2 #{settings_section_active?(:lorebooks) ? "tab-active" : ""}" do %>
              <span class="icon-[lucide--book-open] size-4"></span>
              <%= t("settings.lorebooks.title", default: "Lorebooks") %>
            <% end %>
          </div>
        </div>

        <%# Desktop sidebar menu %>
        <nav class="hidden lg:block sticky top-20">
          <ul class="menu bg-base-200 rounded-box w-full gap-1">
            <li class="menu-title text-xs uppercase tracking-wider">
              <%= t("settings.title", default: "Settings") %>
            </li>
            <li>
              <%= link_to settings_llm_providers_path,
                          class: "gap-3 transition-colors #{settings_section_active?(:llm_providers) ? "menu-active" : "hover:bg-base-300/60 focus-visible:bg-base-300/60"}" do %>
                <span class="icon-[lucide--bot] size-5"></span>
                <%= t("settings.llm_providers.title", default: "LLM Providers") %>
              <% end %>
            </li>
            <li>
              <%= link_to settings_characters_path,
                          class: "gap-3 transition-colors #{settings_section_active?(:characters) ? "menu-active" : "hover:bg-base-300/60 focus-visible:bg-base-300/60"}" do %>
                <span class="icon-[lucide--users] size-5"></span>
                <%= t("settings.characters.title", default: "Characters") %>
              <% end %>
            </li>
            <li>
              <%= link_to settings_presets_path,
                          class: "gap-3 transition-colors #{settings_section_active?(:presets) ? "menu-active" : "hover:bg-base-300/60 focus-visible:bg-base-300/60"}" do %>
                <span class="icon-[lucide--sliders-horizontal] size-5"></span>
                <%= t("settings.presets.title", default: "Presets") %>
              <% end %>
            </li>
            <li>
              <%= link_to settings_lorebooks_path,
                          class: "gap-3 transition-colors #{settings_section_active?(:lorebooks) ? "menu-active" : "hover:bg-base-300/60 focus-visible:bg-base-300/60"}" do %>
                <span class="icon-[lucide--book-open] size-5"></span>
                <%= t("settings.lorebooks.title", default: "Lorebooks") %>
              <% end %>
            </li>
            <li class="menu-title text-xs uppercase tracking-wider mt-4">
              <%= t("settings.administration.title", default: "Administration") %>
            </li>
            <li>
              <%= link_to settings_general_path,
                          class: "gap-3 transition-colors #{settings_section_active?(:general) ? "menu-active" : "hover:bg-base-300/60 focus-visible:bg-base-300/60"}" do %>
                <span class="icon-[lucide--settings] size-5"></span>
                <%= t("settings.general.title", default: "General") %>
              <% end %>
            </li>
            <li>
              <%= link_to settings_users_path,
                          class: "gap-3 transition-colors #{settings_section_active?(:users) ? "menu-active" : "hover:bg-base-300/60 focus-visible:bg-base-300/60"}" do %>
                <span class="icon-[lucide--shield] size-5"></span>
                <%= t("settings.users.title", default: "Users") %>
              <% end %>
            </li>
            <li>
              <%= link_to settings_invite_codes_path,
                          class: "gap-3 transition-colors #{settings_section_active?(:invite_codes) ? "menu-active" : "hover:bg-base-300/60 focus-visible:bg-base-300/60"}" do %>
                <span class="icon-[lucide--ticket] size-5"></span>
                <%= t("settings.invite_codes.title", default: "Invite Codes") %>
              <% end %>
            </li>
          </ul>
        </nav>
      </aside>

      <%# Main content %>
      <div class="flex-1 min-w-0">
        <%= yield %>
      </div>
    </div>
  </main>
<% end %>

<%= render template: "layouts/base" %>
