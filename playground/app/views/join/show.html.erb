<% content_for :title, t("join.title", default: "Join Tavern") %>

<div class="min-h-dvh flex items-center justify-center p-4 relative">
  <%# Theme toggle in corner %>
  <label class="btn btn-ghost btn-sm btn-square swap swap-rotate absolute top-4 right-4" data-controller="theme">
    <input type="checkbox" data-theme-target="checkbox" data-action="change->theme#toggle" />
    <span class="icon-[lucide--sun] size-5 swap-off"></span>
    <span class="icon-[lucide--moon] size-5 swap-on"></span>
  </label>
  <div class="card bg-base-100 shadow-xl w-full max-w-md">
    <div class="card-body">
      <div class="text-center mb-6">
        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 mb-4">
          <span class="icon-[lucide--user-plus] size-8 text-primary"></span>
        </div>
        <h1 class="card-title text-2xl justify-center">
          <%= t("join.title", default: "Join Tavern") %>
        </h1>
        <p class="text-base-content/60 mt-2"><%= t("join.description", default: "Create your account to get started.") %></p>
        <div class="badge badge-success gap-2 mt-3">
          <span class="icon-[lucide--check-circle] size-4"></span>
          <%= t("join.valid_code", default: "Valid invite code") %>
        </div>
      </div>

      <% if flash[:alert].present? %>
        <div role="alert" class="alert alert-error mb-4">
          <span class="icon-[lucide--circle-alert] size-5"></span>
          <span><%= flash[:alert] %></span>
        </div>
      <% end %>

      <%= form_with model: @user, url: join_path(@invite_code.code), class: "space-y-4" do |f| %>
        <div class="form-control">
          <%= f.label :name, t("join.form.name", default: "Name"), class: "label" %>
          <%= f.text_field :name,
              class: "input input-bordered w-full",
              placeholder: t("join.form.name_placeholder", default: "Your display name"),
              required: true,
              autofocus: true %>
        </div>

        <div class="form-control">
          <%= f.label :email, t("join.form.email", default: "Email"), class: "label" %>
          <%= f.email_field :email,
              class: "input input-bordered w-full",
              placeholder: t("join.form.email_placeholder", default: "you@example.com"),
              required: true,
              autocomplete: "email" %>
          <label class="label">
            <span class="label-text-alt"><%= t("join.form.email_hint", default: "Required for login and password recovery.") %></span>
          </label>
        </div>

        <div class="form-control">
          <%= f.label :password, t("join.form.password", default: "Password"), class: "label" %>
          <%= f.password_field :password,
              class: "input input-bordered w-full",
              placeholder: t("join.form.password_placeholder", default: "At least 6 characters"),
              required: true,
              minlength: 6 %>
        </div>

        <div class="form-control mt-6">
          <%= f.submit t("join.form.submit", default: "Create Account"), class: "btn btn-primary w-full" %>
        </div>
      <% end %>

      <div class="divider text-sm text-base-content/50"><%= t("join.or", default: "OR") %></div>
      <div class="text-center">
        <p class="text-sm text-base-content/60">
          <%= t("join.already_have_account", default: "Already have an account?") %>
          <%= link_to t("join.sign_in", default: "Sign in"), new_session_path, class: "link link-primary" %>
        </p>
      </div>
    </div>
  </div>
</div>
